---
title: "Baseline 1"
author: "UIUC"
date: "2023-01-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

library(ggplot2)
library(scales)
library(reshape2)
library(tidyverse)

```

```{r}
BS1 <- read.csv(file = "Baseline1.csv", header = TRUE )
Order<-(BS1$Scenarios2[1:12])


BS1$Scenarios <- as.factor(BS1$Scenarios)
BS1$Scenarios2 <- as.factor(BS1$Scenarios2)

BS1$Relative_Efficacy <-as.numeric(BS1$Relative_Efficacy)

BS1

Fig1 <- ggplot(BS1, aes(fill=Contamination, x=factor(Scenarios2, levels = rev(Order)), y=Relative_Efficacy)) + 
  geom_bar(position = "dodge", stat = "identity") + 
  labs(title="Unintentional irrigation with contaminated water every day of a growing cycle", y="Fraction of oocysts rejected by sampling scenario", x="Sampling Scenario")+
  scale_fill_discrete(name = "Contamination \nLevel")+#(values=c("#FF3366","#99CCFF")) +
  scale_y_continuous(labels = scales::percent)+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5))+
  #theme(axis.text.x = element_text(angle=45, vjust=1, hjust=1))+
  coord_flip()+
  theme(axis.text.x=element_text(size =12), axis.text.y=element_text(size =12),axis.title = element_text(size = 12))

Fig1

ggsave("Baseline1-Present.jpg", width =9, height = 7, units = "in", dpi = 300)


```

```{r}

BS2 <- read.csv(file = "Baseline2.csv", header = TRUE )

Order<-(BS2$Scenarios2[1:12])


BS2$Scenarios <- as.factor(BS2$Scenarios)
BS2$Scenarios2 <- as.factor(BS2$Scenarios2)

BS2$Relative_Efficacy <-as.numeric(BS2$Relative_Efficacy)

BS2

Fig2 <- ggplot(BS2, aes(fill=Contamination, x=factor(Scenarios2, levels = rev(Order)), y=Relative_Efficacy)) + 
  geom_bar(position = "dodge", stat = "identity") + 
  labs(title="Unintentional irrigation with contaminated water\n one random day during the growing cycle", y="Fraction of oocysts rejected by sampling scenario", x="Sampling Scenario")+
  scale_fill_discrete(name = "Contamination \nLevel")+#(values=c("#FF3366","#99CCFF")) +
  scale_y_continuous(labels = scales::percent)+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5))+
  #theme(axis.text.x = element_text(angle=45, vjust=1, hjust=1))+
  coord_flip()+
  theme(axis.text.x=element_text(size =12), axis.text.y=element_text(size =12),axis.title = element_text(size = 12))
  #theme(legend.position=c(0.75, 0.70))
Fig2

ggsave("Baseline2-Presentation.jpg", width =9, height = 7, units = "in", dpi = 300)




```



```{r}
PS_High <- read.csv(file = "ProductTestingClustersHigh.csv", header = TRUE )
PS_High<-PS_High[,-1]
PS_High<-melt(PS_High)


PS_High %>% 
  group_by(variable) %>% 
  summarise(mean = mean(value), q25 = quantile(value, 0.05), q975 = quantile(value, 0.95)) %>% 
  ggplot(aes(x = variable, y = mean, ymin = q25, ymax = q975))+
  geom_col(fill = "skyblue", color = "black")+
  #coord_flip()+
  labs(x = "Contamination Cluster", y = "Detection Rate")+
  theme_bw()

seq(from  = 0.1, to  = 100, length.out = 100)


Detection_Rates_High_DPT<-read.csv(file = "Detection_Rates_High_DPT.csv")
Detection_Rates_High_DPT<-Detection_Rates_High_DPT[,-1]

Detection_Rates_High_DPT %>% 
  ggplot(aes(x = Cluster, y = Drates))+
  geom_point(fill = "skyblue", color = "black")+
  geom_line()+
  labs(x = "Contamination Cluster", y = "Detection Rate")+
  theme_bw()

##############

Detection_Rates_High_DPT<-read.csv(file = "Detection_Rates_High_FPT.csv")
Detection_Rates_High_DPT<-Detection_Rates_High_DPT[,-1]

Detection_Rates_High_DPT %>% 
  ggplot(aes(x = Cluster, y = Drates))+
  geom_point(fill = "skyblue", color = "black")+
  geom_line()+
  labs(x = "Contamination Cluster", y = "Detection Rate")+
  theme_bw()


```

```{r}
PS_High <- read.csv(file = "Detection_Rates_High_FPT.csv", header = TRUE )
PS_High<-PS_High[,-1]
PS_High<-melt(PS_High)


PS_High %>% 
  group_by(variable) %>% 
  summarise(mean = mean(value), q25 = quantile(value, 0.05), q975 = quantile(value, 0.95)) %>% 
  ggplot(aes(x = variable, y = mean, ymin = q25, ymax = q975))+
  geom_col()+
  #coord_flip()+
  labs(x = "Contamination Cluster", y = "Detection Rate")
```


summarize(RE = Total_CFU/Total_CFU[Type=="Baseline"])
Exps_RE<-Exps_all %>%
select(Mass, Type, Total_CFU) %>%
bind_cols(Exps_RE)
Exps_RE$Type<-factor(Exps_RE$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Exps_RE$RE<-1-Exps_RE$RE
Spread_names <-c(
"100%"= "Widespread 100% Cluster",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
Exps_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
scale_color_discrete(name="Sampling Plan")+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21),name="Sampling Plan")
Exps_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
scale_color_discrete(name="Sampling-Testing Plan")+
xlab("Process Stage")+
ylab("Fraction of cells rejected")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21),name="Sampling Plan")
Exps_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
scale_color_discrete(name="Sampling-Testing Plan")+
xlab("Process Stage")+
ylab("Fraction of cells rejected")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21),name="Sampling-Testing Plan")
#ggsave(filename="Plot Outputs/Relative Efficacy.tiff",width = 25, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs/Relative Efficacy.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
#ggsave(filename="Plot Outputs/Relative Efficacy.tiff",width = 25, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs-Figures/Relative Efficacy.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
Powers_ADD<-read.csv("Data_Tomato_Outputs/Powers_Out_Additional.csv")
Powers_ADD$Mass<-as.factor(Powers_ADD$Mass)
Powers_ADD$variable<-as.factor(Powers_ADD$variable)
Powers_ADD$Type<-as.factor(Powers_ADD$Type)
Powers_ADD$Type<-factor(Powers_ADD$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Powers_ADD$Mass<-factor(Powers_ADD$Mass,levels=c("2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Powers_ADD$Cont<-factor(Powers_ADD$Cont,levels=c("Harvesting Bucket", "Harvesting Bin"))
Spread_names <-c(
"100%"= "Widespread Unclustered",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
#Boxplot
Powers_ADD%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
geom_point(position = position_dodge(0.6))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(Cont~variable, nrow =2)+
theme_bw()
# Exposure:
```{r}
Tac_ADD<-read.csv("Data_Tomato_Outputs/TAC_Additional.csv")
Tac_ADD$Mass<-as.factor(Tac_ADD$Mass)
Tac_ADD$Cont<-as.factor(Tac_ADD$Cont)
Tac_ADD$Type<-as.factor(Tac_ADD$Type)
Tac_ADD$Type<-factor(Tac_ADD$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Tac_ADD$Mass<-factor(Tac_ADD$Mass,levels=c("Baseline","2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Tac_ADD$Cont<-factor(Tac_ADD$Cont,levels=c("Harvesting Bucket", "Harvesting Bin"))
TAC_ADD_RE<-Tac_ADD %>%
group_by(Cont) %>%
summarize(RE = Total_CFU/Total_CFU[Type=="Baseline"])
TAC_ADD_RE<-Tac_ADD %>%
select(Mass, Type, Total_CFU) %>%
bind_cols(TAC_ADD_RE)
TAC_ADD_RE$Type<-factor(TAC_ADD_RE$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
TAC_ADD_RE$RE<-1-TAC_ADD_RE$RE
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont)+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
Spread_names <-c(
"Harvesting Bucket"= "Harvesting Bucket 25 small cluster -Total 0.6% Cluster",
"Harvesting Bin" = "Harvesting Bin -2.27% Cluster"
)
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = Spread_names)+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
Tac_ADD<-read.csv("Data_Tomato_Outputs/TAC_Additional.csv")
Tac_ADD$Mass<-as.factor(Tac_ADD$Mass)
Tac_ADD$Cont<-as.factor(Tac_ADD$Cont)
Tac_ADD$Type<-as.factor(Tac_ADD$Type)
Tac_ADD$Type<-factor(Tac_ADD$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Tac_ADD$Mass<-factor(Tac_ADD$Mass,levels=c("Baseline","2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Tac_ADD$Cont<-factor(Tac_ADD$Cont,levels=c("Harvesting Bucket", "Harvesting Bin"))
TAC_ADD_RE<-Tac_ADD %>%
group_by(Cont) %>%
summarize(RE = Total_CFU/Total_CFU[Type=="Baseline"])
TAC_ADD_RE<-Tac_ADD %>%
select(Mass, Type, Total_CFU) %>%
bind_cols(TAC_ADD_RE)
TAC_ADD_RE$Type<-factor(TAC_ADD_RE$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
TAC_ADD_RE$RE<-1-TAC_ADD_RE$RE
Spread_names <-c(
"Harvesting Bucket"= "Harvesting Bucket 25 small cluster -Total 0.6% Cluster",
"Harvesting Bin" = "Harvesting Bin -2.27% Cluster"
)
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = Spread_names)+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = Spread_names)+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
#facet_wrap(~Cont, labeller = Spread_names)+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
Spread_names
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
Exps_Other %>%
ggplot(aes(x = Type, y = FS, fill = Mass))+
geom_col(position = position_dodge())+
coord_flip()+
geom_hline(yintercept = -1.69,linetype="dashed",
color = "black", size=1)+
facet_wrap(~Cont)+
xlab("Sampling Location")+
ylab("Factor Senstivity FS | log10 (Scenario/Baseline)")+
theme_bw()
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
ggsave(filename="Plot Outputs/Relative Efficacy -Additional Outputs.jpeg",width = 15, height = 10, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs-Figures/Relative Efficacy -Additional Outputs.jpeg",width = 15, height = 10, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs-Figures/Relative Efficacy -Additional Outputs.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
Spread_names <-c(
"Harvesting Bucket"= "Harvesting Bucket 25 small cluster - Total 0.6% Cluster",
"Harvesting Bin" = "Harvesting Bin - 2.27% Cluster"
)
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
ggsave(filename="Plot Outputs-Figures/Relative Efficacy -Additional Outputs.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
Spread_names <-c(
"Harvesting Bucket"= "Harvesting Bucket: 25 small cluster - Total 0.6%",
"Harvesting Bin" = "Harvesting Bin - 2.27% Cluster"
)
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
ggsave(filename="Plot Outputs-Figures/Relative Efficacy -Additional Outputs.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
xlab("Process Stage")+
ylab("Fraction of cells rejected")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
ggsave(filename="Plot Outputs-Figures/Relative Efficacy -Additional Outputs.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs-Figures/Relative Efficacy -Additional Outputs.jpeg",width = 205, height = 15, units = "cm", dpi = 600)
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
xlab("Process Stage")+
ylab("Fraction of cells rejected")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
ggsave(filename="Plot Outputs-Figures/Relative Efficacy -Additional Outputs.jpeg",width = 205, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs-Figures/Relative Efficacy -Additional Outputs.jpeg",width = 20, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs-Figures/Relative Efficacy -Additional Outputs.jpeg",width = 20, height = 12, units = "cm", dpi = 600)
Tac_ADD<-read.csv("Data_Tomato_Outputs/TAC_Additional.csv")
Tac_ADD$Mass<-as.factor(Tac_ADD$Mass)
Tac_ADD$Cont<-as.factor(Tac_ADD$Cont)
Tac_ADD$Type<-as.factor(Tac_ADD$Type)
Tac_ADD$Type<-factor(Tac_ADD$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Tac_ADD$Mass<-factor(Tac_ADD$Mass,levels=c("Baseline","2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Tac_ADD$Cont<-factor(Tac_ADD$Cont,levels=c("Harvesting Bucket", "Harvesting Bin"))
TAC_ADD_RE<-Tac_ADD %>%
group_by(Cont) %>%
summarize(RE = Total_CFU/Total_CFU[Type=="Baseline"])
TAC_ADD_RE<-Tac_ADD %>%
select(Mass, Type, Total_CFU) %>%
bind_cols(TAC_ADD_RE)
TAC_ADD_RE$Type<-factor(TAC_ADD_RE$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
TAC_ADD_RE$RE<-1-TAC_ADD_RE$RE
Spread_names <-c(
"Harvesting Bucket"= "Harvesting Bucket: 25 small cluster - Total 0.6%",
"Harvesting Bin" = "Harvesting Bin - 2.27% Cluster"
)
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
xlab("Process Stage")+
ylab("Fraction of cells rejected")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
ggsave(filename="Plot Outputs-Figures/Relative Efficacy -Additional Outputs.jpeg",width = 20, height = 12, units = "cm", dpi = 600)
Cont_Prog<-read.csv("Data_Tomato_Outputs/PrevSampPoint_Rep.csv")
Cont_Prog$Type[Cont_Prog$Type == "PH"] <- "Preharvest"
Cont_Prog$Type[Cont_Prog$Type == "H"] <- "Harvest"
Cont_Prog$Type[Cont_Prog$Type == "R"] <- "Receiving"
Cont_Prog$Type[Cont_Prog$Type == "PP"] <- "Packed Product"
Cont_Prog$Type<-as.factor(Cont_Prog$Type)
Cont_Prog$Pick<-as.factor(Cont_Prog$Pick)
Cont_Prog$Type<-factor(Cont_Prog$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Cont_Prog$`Cont.Type`<-factor(Cont_Prog$`Cont.Type`,levels=c("100%", "10%", "1%", "0.1%"))
Spread_names <-c(
"100%"= "Widespread - 100% Cluster",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
Cont_Prog %>%
ggplot(aes(x = Type, y = Cont,color = Pick))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot()+
xlab("Sampling Plan")+ ylab ("Prevalence (Tomatoes> 1CFU/Tomato Tomatoes) at sampling point")+
facet_wrap(~`Cont.Type`, scales = "free_y",labeller=as_labeller(Spread_names))+
scale_y_continuous(labels = scales::comma)+
theme_bw()
ggsave(filename="Plot Outputs-Figures/Figure-S2-PrevSampPoints.png",width = 25, height = 15, units = "cm", dpi = 600)
Cont_Prog %>%
group_by(Type, `Cont.Type`) %>%
summarise(mean = mean(Cont), q95 = quantile(Cont, 0.95), q05 = quantile(Cont, 0.05))
Cont_Prog<-read.csv("Data_Tomato_Outputs/SampPoint_Rep.csv")
Cont_Prog$Type[Cont_Prog$Type == "PH"] <- "Preharvest"
Cont_Prog$Type[Cont_Prog$Type == "H"] <- "Harvest"
Cont_Prog$Type[Cont_Prog$Type == "R"] <- "Receiving"
Cont_Prog$Type[Cont_Prog$Type == "PP"] <- "Packed Product"
Cont_Prog$Type<-as.factor(Cont_Prog$Type)
Cont_Prog$Pick<-as.factor(Cont_Prog$Pick)
Cont_Prog$Type<-factor(Cont_Prog$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Cont_Prog$`Cont.Type`<-factor(Cont_Prog$`Cont.Type`,levels=c("100%", "10%", "1%", "0.1%"))
Spread_names <-c(
"100%"= "Widespread 100% Cluster",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
Cont_Prog %>%
ggplot(aes(x = Type, y = Cont,color = Pick))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot()+
xlab("Sampling Plan")+ ylab ("Total Adulteran Cells (TAC) at sampling point")+
facet_wrap(~`Cont.Type`,labeller=as_labeller(Spread_names))+
scale_y_continuous(labels = scales::comma)+
theme_bw()
ggsave(filename="Plot Outputs-Figures/Figure-S1-ContSampPoints.png",width = 25, height = 15, units = "cm", dpi = 600)
Cont_Prog %>%
group_by(Type, Mass, Cont.Type) %>%
summarise(mean = mean(Cont), q95 = quantile(Cont, 0.95), q05 = quantile(Cont, 0.05))
Powers<-read.csv("Data_Tomato_Outputs/Powers_Out_Rep.csv")
Powers$Mass<-as.factor(Powers$Mass)
Powers$variable<-as.factor(Powers$variable)
Powers$Type<-as.factor(Powers$Type)
Powers$Type<-factor(Powers$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Powers$Mass<-factor(Powers$Mass,levels=c("2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Powers$Cont<-factor(Powers$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Powers_Summary = Powers %>%
group_by(Type, Mass, variable, Cont) %>%
#summarise(mean = median(value), CI_95 = mean + margin_calc(value),CI_05 = mean - margin_calc(value))
summarise(mean = median(value), CI_95 = quantile(value, 0.90),CI_05 = quantile(value, 0.1))
Powers_Summary
Powers$Mass<-as.factor(Powers$Mass)
Powers$variable<-as.factor(Powers$variable)
Powers$Type<-as.factor(Powers$Type)
Powers$Type<-factor(Powers$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Powers$Mass<-factor(Powers$Mass,levels=c("2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Powers$Cont<-factor(Powers$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Powers
aov(value~variable+type+`Mass Cont`, data =Powers )
aov(value~variable+Type+`Mass Cont`, data =Powers )
aov(Powers$value~Powers$variable+Powers$Type+Powers$`Mass Cont`)
aov(Powers$value~Powers$variable+Powers$Type+Powers$Mass+Powers$Cont)
anova<-aov(Powers$value~Powers$variable+Powers$Type+Powers$Mass+Powers$Cont)
summary(aov)
summary(anova)
Powers_Summary = Powers %>%
group_by(Type, Mass, variable, Cont) %>%
#summarise(mean = median(value), CI_95 = mean + margin_calc(value),CI_05 = mean - margin_calc(value))
summarise(mean = mean(value), CI_95 = quantile(value, 0.90),CI_05 = quantile(value, 0.1))
Powers_Summary$Cont<-str_replace("100%", string = Powers_Summary$Cont, replacement = "Widespread-100% Cluster")
Powers_Summary$Cont<-str_replace("10%", string = Powers_Summary$Cont, replacement = "10% Cluster")
Powers_Summary$Cont<-str_replace("1%$", string = Powers_Summary$Cont, replacement = "1% Cluster")
Powers_Summary$Cont<-str_replace("0.1%$", string = Powers_Summary$Cont, replacement = "0.1% Cluster")
Powers_Summary$Cont<-factor(Powers_Summary$Cont,levels=c("Widespread-100% Cluster", "10% Cluster", "1% Cluster", "0.1% Cluster"))
Powers_Summary %>%
ggplot(aes(x = Type, y = mean, color = Mass,shape = variable ,group = interaction(Mass, variable)))+
#geom_point(stroke = 4,position = position_dodge(0.3))+
#geom_line(aes(linetype= variable),size = 0.3,position = position_dodge(0.3))+
geom_pointrange(aes(ymin=CI_05, ymax=CI_95),position = position_dodge(0.7), size = 0.5)+
geom_errorbar(aes(ymin=CI_05, ymax=CI_95),width = 0.5, size =0.5,position = position_dodge(0.7))+
ylab("Detection Rate")+
xlab("Process Stage")+
#scale_size_manual(name = "Tomatoes Sampled")+
scale_color_discrete(name="Sampling-Testing Plan")+
scale_shape_discrete(name="Pick Number",labels = c("Power_Pick_1" ="Pick 1", "Power_Pick_2" ="Pick 2", "Power_Pick_3" ="Pick 3") )+
scale_linetype_discrete(name="Pick Number",labels = c("Power_Pick_1" ="Pick 1", "Power_Pick_2" ="Pick 2", "Power_Pick_3" ="Pick 3"))+
facet_wrap(~Cont,nrow = 2)+
theme_bw()
Powers_Summary = Powers %>%
group_by(Type, Mass, variable, Cont) %>%
#summarise(mean = median(value), CI_95 = mean + margin_calc(value),CI_05 = mean - margin_calc(value))
summarise(mean = median(value), CI_95 = quantile(value, 0.90),CI_05 = quantile(value, 0.1))
Powers_Summary$Cont<-str_replace("100%", string = Powers_Summary$Cont, replacement = "Widespread-100% Cluster")
Powers_Summary$Cont<-str_replace("10%", string = Powers_Summary$Cont, replacement = "10% Cluster")
Powers_Summary$Cont<-str_replace("1%$", string = Powers_Summary$Cont, replacement = "1% Cluster")
Powers_Summary$Cont<-str_replace("0.1%$", string = Powers_Summary$Cont, replacement = "0.1% Cluster")
Powers_Summary$Cont<-factor(Powers_Summary$Cont,levels=c("Widespread-100% Cluster", "10% Cluster", "1% Cluster", "0.1% Cluster"))
Powers_Summary %>%
ggplot(aes(x = Type, y = mean, color = Mass,shape = variable ,group = interaction(Mass, variable)))+
#geom_point(stroke = 4,position = position_dodge(0.3))+
#geom_line(aes(linetype= variable),size = 0.3,position = position_dodge(0.3))+
geom_pointrange(aes(ymin=CI_05, ymax=CI_95),position = position_dodge(0.7), size = 0.5)+
geom_errorbar(aes(ymin=CI_05, ymax=CI_95),width = 0.5, size =0.5,position = position_dodge(0.7))+
ylab("Detection Rate")+
xlab("Process Stage")+
#scale_size_manual(name = "Tomatoes Sampled")+
scale_color_discrete(name="Sampling-Testing Plan")+
scale_shape_discrete(name="Pick Number",labels = c("Power_Pick_1" ="Pick 1", "Power_Pick_2" ="Pick 2", "Power_Pick_3" ="Pick 3") )+
scale_linetype_discrete(name="Pick Number",labels = c("Power_Pick_1" ="Pick 1", "Power_Pick_2" ="Pick 2", "Power_Pick_3" ="Pick 3"))+
facet_wrap(~Cont,nrow = 2)+
theme_bw()
ggsave(filename="Plot Outputs-Figures/Powers_Per_Pick.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
anova<-aov(Powers$value~Powers$variable+Powers$Type+Powers$Mass+Powers$Cont)
summary(anova)
library(tidyverse)
Validation_FDA<-read_csv("Data_Cilantro_Outputs/RR_FDA_Validation.csv")
Validation_FDA<-read_csv("Data/RR_FDA_Validation.csv")
#product Testing
PT_Qpcr_Results<-read_csv("Data_Cilantro_Outputs/qPCR_Fit_Product_Testing.csv")
#product Testing
PT_Qpcr_Results<-read_csv("Data/qPCR_Fit_Product_Testing.csv")
PT_Qpcr_Probs<-read_csv("Data/qPCR_Fit_Product_Testing_Probs.csv")
setwd("~/GitHubFiles/CPS-Farm-To-Facility-Cilantro")
#product Testing
PT_Qpcr_Results<-read_csv("Data/qPCR_Fit_Product_Testing.csv")
PT_Qpcr_Probs<-read_csv("Data/qPCR_Fit_Product_Testing_Probs.csv")
ggplot()+
geom_hline(aes(yintercept = .29),color = "orange")+
geom_hline(aes(yintercept = .82),color = "red")+
geom_vline(aes(xintercept = 5),color = "orange")+
geom_vline(aes(xintercept = 10),color = "red")+
geom_line(aes(x = Cont, y = `Prob Detect`), data = PT_Qpcr_Probs)+
geom_point(aes(x = Cont, y = Results), data = PT_Qpcr_Results,position = position_jitter(height = 0.01, width = 1),shape= 21, fill = "skyblue")+
labs(x= "Oocyst/ 25 g Sample", y = "Predicted Probability of Detection", title = "Logistic Fit: Product Testing")+
theme_bw()
ggplot()+
geom_hline(aes(yintercept = .262),color = "orange")+
geom_hline(aes(yintercept = .825),color = "red")+
geom_vline(aes(xintercept = 5),color = "orange")+
geom_vline(aes(xintercept = 10),color = "red")+
geom_line(aes(x = Cont, y = `Prob Detect`), data = PT_Qpcr_Probs)+
geom_point(aes(x = Cont, y = Results), data = PT_Qpcr_Results,position = position_jitter(height = 0.01, width = 1),shape= 21, fill = "skyblue")+
labs(x= "Oocyst/ 25 g Sample", y = "Predicted Probability of Detection", title = "Logistic Fit: Product Testing")+
theme_bw()
ggplot()+
geom_hline(aes(yintercept = .262),color = "orange")+
geom_hline(aes(yintercept = .825),color = "red")+
geom_vline(aes(xintercept = 5),color = "orange")+
geom_vline(aes(xintercept = 10),color = "red")+
geom_line(aes(x = Cont, y = `Prob Detect`), data = PT_Qpcr_Probs)+
geom_point(aes(x = Cont, y = Results), data = PT_Qpcr_Results,position = position_jitter(height = 0.01, width = 1),shape= 21, fill = "skyblue")+
labs(x= "Oocyst/ 25 g Sample", y = "Predicted Detection Rate", title = "Logistic Fit: Product Testing")+
theme_bw()
ggsave(filename="Figures/Product Testing Fit.png",width = 10, height = 10, units = "cm", dpi = 600)
#Water Testing
WT_Qpcr_Results<-read_csv("Data_Cilantro_Outputs/qPCR_Fit_Water_Testing.csv")
WT_Qpcr_Probs<-read_csv("Data_Cilantro_Outputs/qPCR_Fit_Water_Testing_Probs.csv")
ggplot()+
#geom_hline(aes(yintercept = .29),color = "orange")+
geom_hline(aes(yintercept = .656),color = "red")+
#geom_vline(aes(xintercept = 5),color = "orange")+
geom_vline(aes(xintercept = 6),color = "red")+
geom_line(aes(x = Cont, y = `Prob Detect`), data = PT_Qpcr_Probs)+
geom_point(aes(x = Cont, y = Results), data = PT_Qpcr_Results,position = position_jitter(height = 0.01, width = 1),shape= 21, fill = "skyblue")+
labs(x= "Oocyst/ 10L Sample", y = "Predicted Detection Rate", title = "Logistic Fit: Agricultural Water Testing")+
theme_bw()
ggsave(filename="Water Testing Fit.png",width = 10, height = 10, units = "cm", dpi = 600)
ggsave(filename="Figures/Water Testing Fit.png",width = 10, height = 10, units = "cm", dpi = 600)
ggplot()+
#geom_hline(aes(yintercept = .29),color = "orange")+
geom_hline(aes(yintercept = .66),color = "red")+
#geom_vline(aes(xintercept = 5),color = "orange")+
geom_vline(aes(xintercept = 6),color = "red")+
geom_line(aes(x = Cont, y = `Prob Detect`), data = PT_Qpcr_Probs)+
geom_point(aes(x = Cont, y = Results), data = PT_Qpcr_Results,position = position_jitter(height = 0.01, width = 1),shape= 21, fill = "skyblue")+
labs(x= "Oocyst/ 10L Sample", y = "Predicted Detection Rate", title = "Logistic Fit: Agricultural Water Testing")+
theme_bw()
ggplot()+
geom_hline(aes(yintercept = .66),color = "red")+
geom_vline(aes(xintercept = 6),color = "red")+
geom_line(aes(x = Cont, y = `Prob Detect`), data = WT_Qpcr_Probs)+
geom_point(aes(x = Cont, y = Results), data = PT_Qpcr_Results,position = position_jitter(height = 0.01, width = 1),shape= 21, fill = "skyblue")+
labs(x= "Oocyst/ 10L Sample", y = "Predicted Detection Rate", title = "Logistic Fit: Agricultural Water Testing")+
theme_bw()
ggplot()+
geom_hline(aes(yintercept = .66),color = "red")+
geom_vline(aes(xintercept = 6),color = "red")+
geom_line(aes(x = Cont, y = `Prob Detect`), data = WT_Qpcr_Probs)+
geom_point(aes(x = Cont, y = Results), data = WT_Qpcr_Results,position = position_jitter(height = 0.01, width = 1),shape= 21, fill = "skyblue")+
labs(x= "Oocyst/ 10L Sample", y = "Predicted Detection Rate", title = "Logistic Fit: Agricultural Water Testing")+
theme_bw()
#Water Testing
WT_Qpcr_Results<-read_csv("Data_Cilantro_Outputs/qPCR_Fit_Water_Testing.csv")
#Water Testing
WT_Qpcr_Results<-read_csv("Data/qPCR_Fit_Water_Testing.csv")
WT_Qpcr_Probs<-read_csv("Data/qPCR_Fit_Water_Testing_Probs.csv")
ggplot()+
geom_hline(aes(yintercept = .66),color = "red")+
geom_vline(aes(xintercept = 6),color = "red")+
geom_line(aes(x = Cont, y = `Prob Detect`), data = WT_Qpcr_Probs)+
geom_point(aes(x = Cont, y = Results), data = WT_Qpcr_Results,position = position_jitter(height = 0.01, width = 1),shape= 21, fill = "skyblue")+
labs(x= "Oocyst/ 10L Sample", y = "Predicted Detection Rate", title = "Logistic Fit: Agricultural Water Testing")+
theme_bw()
ggsave(filename="Figures/Water Testing Fit.png",width = 10, height = 10, units = "cm", dpi = 600)
ggplot()+
geom_hline(aes(yintercept = .313),color = "orange")+
geom_hline(aes(yintercept = .80),color = "red")+
geom_vline(aes(xintercept = 5),color = "orange")+
geom_vline(aes(xintercept = 10),color = "red")+
geom_line(aes(x = Cont, y = `Prob Detect`), data = PT_Qpcr_Probs)+
geom_point(aes(x = Cont, y = Results), data = PT_Qpcr_Results,position = position_jitter(height = 0.01, width = 1),shape= 21, fill = "skyblue")+
labs(x= "Oocyst/ 25 g Sample", y = "Predicted Detection Rate", title = "Logistic Fit: Product Testing")+
theme_bw()
ggsave(filename="Figures/Product Testing Fit.png",width = 10, height = 10, units = "cm", dpi = 600)
